<%= turbo_stream.append "messages_conversation_#{@conversation.id}" do %>
  <%= render "messages/message", message: @message %>
  <script>
    document.getElementById("messages_conversation_<%= @conversation.id %>").scrollTop = 
    document.getElementById("messages_conversation_<%= @conversation.id %>").scrollHeight;
  </script>
<% end %>

<%= turbo_stream.update "message_form" do %>
  <%= form_with(model: [@conversation, Message.new],
                class: "d-flex align-items-center gap-2",
                data: { controller: "reset-form", action: "turbo:submit-end->reset-form#reset" }) do |f| %>
    <%= f.text_field :content, 
        class: "form-control",
        placeholder: "Type your message...",
        autocomplete: "off",
        data: { 
          controller: "textarea-autogrow",
          action: "keydown->textarea-autogrow#submit"
        } %>
    <%= f.button class: "btn btn-send" do %>
      <i class="fas fa-paper-plane text-white"></i>
    <% end %>
  <% end %>
<% end %>
